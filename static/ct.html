<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hands</title>
    <link rel="stylesheet" href="/static/style.css">  
    
</head>
<body>
    <h1>Categories</h1>
    <nav>
        <a href="/home"><button>Home</button></a>
        <a href="/categories"><button>Categories</button></a>
        <a href="/profile"><button>Profile</button></a>
        <a href="/settings"><button>Settings</button></a>
        <a href="/aboutus"><button>About Us</button></a>
    </nav>

    <form method="get" action="/categories">
        <fieldset>
            <legend>Filter:</legend>
            {% for cat in ['Clothing & Gear', 'Navigation & Surveillance', 'Communication Equipment', 'Shelter & Sleeping Gear', 'Food & Water Supplies', '
            Medical & First Aid', 'Tools & Repair Kits', 'Power & Energy', 'Vehicle & Transport Support', 'Protective Equipment'] %}
                <label>
                    <input type="checkbox" name="category" value="{{ cat }}"
                           {% if selected_categories and cat in selected_categories %}checked{% endif %}>
                    {{ cat }}
                </label><br>
            {% endfor %}
        </fieldset>
        <button type="submit">Save</button>
    </form>
    <ul>
        {% for request in requests %}
            <li>
                <strong>{{ request.name }}</strong><br>
                {{ request.description }}<br>
                <strong>Categories:</strong>
                {% if request.categories %}
                    <ul>
                        {% for cat in request.categories.split(',') %}
                            <li>{{ cat.strip() }}</li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <em>—</em><br>
                {% endif %}
                Status: 
                {% if request.state == 1 %}
                    Active
                {% elif request.state == 2 %}
                    In progress
                {% elif request.state == 3 %}
                    Closed
                {% else %}
                    Unknown
                {% endif %}<br>
                Creation date: 
                <span class="created-at" data-created="{{ request.created_at.isoformat() if request.created_at else '' }}Z">
                    {{ request.created_at.strftime('%Y-%m-%d %H:%M:%S') if request.created_at else '—' }}
                </span><br>
                <img src="/{{ request.image_path }}" alt="Request Image" height="100px"><br><br>
            </li>
        {% endfor %}
    </ul>
    <script>
        function timeAgo(date) {
            const seconds = Math.floor((new Date() - date) / 1000);
    
            const intervals = [
                { label: 'year', seconds: 31536000 },
                { label: 'month', seconds: 2592000 },
                { label: 'day', seconds: 86400 },
                { label: 'hour', seconds: 3600 },
                { label: 'minute', seconds: 60 },
                { label: 'second', seconds: 1 }
            ];
    
            for (const interval of intervals) {
                const count = Math.floor(seconds / interval.seconds);
                if (count >= 1) {
                    return `${count} ${interval.label}${count !== 1 ? 's' : ''} ago`;
                }
            }
            return 'just now';
        }
    
        document.addEventListener("DOMContentLoaded", () => {
            document.querySelectorAll('.created-at').forEach(el => {
                const isoDate = el.dataset.created;
                if (!isoDate) return;
    
                const utcDate = new Date(isoDate); // isoDate вже має бути з 'Z' (UTC)
                const localDateString = utcDate.toLocaleString();
                const ago = timeAgo(utcDate);
    
                el.innerHTML = `${localDateString} (${ago})`;
            });
        });
    </script>    
    
</body>
</html> -->


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Hands — Categories</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <div id="header"></div>

  <main class="main-content-categories">
    <div class="filter-panel-categories">
      <h3>Choose category:</h3>
      <label><input type="checkbox" value="Vehicles, drones"> Vehicles, drones</label>
      <label><input type="checkbox" value="Household supplies"> Household supplies</label>
      <label><input type="checkbox" value="Communication devices"> Communication devices</label>
      <label><input type="checkbox" value="Medicine"> Medicine</label>
      <label><input type="checkbox" value="Protective gear"> Protective gear</label>
      <label><input type="checkbox" value="Furniture"> Furniture</label>
      <label><input type="checkbox" value="Clothes"> Clothes</label>
      <a onclick="selectAll()">Pick all</a>
      <button onclick="applyFilters()">Apply filters</button>
    </div>

    <div class="cards-container-categories" id="cards-container">
      <div class="request-card-categories" data-category="Medicine">
        <div class="card-content-categories">Request: Ibuprofen tablets</div>
        <div class="card-footer-categories">
          <span class="category-tag-categories">Medicine</span>
          <a class="arrow-link-categories" href="published_activity.html">↗</a>
        </div>
      </div>
      <div class="request-card-categories" data-category="Medicine">
        <div class="card-content-categories">Request: Band aids</div>
        <div class="card-footer-categories">
          <span class="category-tag-categories">Medicine</span>
          <a class="arrow-link-categories" href="published_activity.html">↗</a>
        </div>
      </div>
      <div class="request-card-categories" data-category="Furniture">
        <div class="card-content-categories">Request: Metal cabinets</div>
        <div class="card-footer-categories">
          <span class="category-tag-categories">Furniture</span>
          <a class="arrow-link-categories" href="published_activity.html">↗</a>
        </div>
      </div>
      <div class="request-card-categories" data-category="Furniture">
        <div class="card-content-categories">Request: Folding bed</div>
        <div class="card-footer-categories">
          <span class="category-tag-categories">Furniture</span>
          <a class="arrow-link-categories" href="published_activity.html">↗</a>
        </div>
      </div>
      <div class="request-card-categories" data-category="Medicine, Furniture, Protective gear">
        <div class="card-content-categories">Request: First-aid cabinet with safety gear</div>
        <div class="card-footer-categories">
          <div>
            <span class="category-tag-categories">Medicine</span>
            <span class="category-tag-categories">Furniture</span>
            <span class="category-tag-categories">Protective gear</span>
          </div>
          <a class="arrow-link-categories" href="published_activity.html">↗</a>
        </div>
      </div>      
    </div>
  </main>

  <div id="footer"></div>

  <script>
    fetch('/static/header.html')
      .then(response => response.text())
      .then(html => {
        document.getElementById('header').innerHTML = html;
      });

    fetch('/static/footer.html')
      .then(response => response.text())
      .then(html => {
        document.getElementById('footer').innerHTML = html;
      });

      function applyFilters() {
        const checkboxes = document.querySelectorAll('.filter-panel-categories input[type="checkbox"]:checked');
        const selectedCategories = Array.from(checkboxes).map(cb => cb.value);
        const cards = document.querySelectorAll('.request-card-categories');

        cards.forEach(card => {
            const categories = card.getAttribute('data-category').split(',').map(c => c.trim());
            const hasMatch = categories.some(cat => selectedCategories.includes(cat));
            card.style.display = hasMatch ? 'flex' : 'none';
        });
    }


    function selectAll() {
      document.querySelectorAll('.filter-panel-categories input[type="checkbox"]').forEach(cb => cb.checked = true);
    }
  </script>
</body>
</html>
